{
  "$schema": "https://promptg.io/schemas/v1/pack.schema.json",
  "kind": "pack",
  "schemaVersion": "1",
  "name": "security-champion-threat-first",
  "version": "0.1.0",
  "displayName": "Security Champion: Threat-First",
  "description": "Security-focused prompts for threat modeling and diff reviews: identify likely vulnerabilities, rate severity, and recommend practical mitigations.",
  "author": "promptg-team",
  "tags": ["starter", "security", "threat-modeling", "review", "diff", "mitigations"],
  "templates": [
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-pr-diff-scan",
      "displayName": "PR Diff Scan",
      "description": "Review a diff for security issues; report severity, evidence, and fixes.",
      "author": "promptg-team",
      "tags": ["security", "review", "diff"],
      "defaults": {
        "goal": "Review the diff for security issues and recommend practical fixes.",
        "constraints": "None.",
        "language": "Unspecified",
        "context": "None."
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Findings, Suggested Fixes, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Findings \u003c= 10 bullets; Suggested Fixes \u003c= 10 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security-focused reviewer who is practical and evidence-driven.\n\nInputs:\n- Goal: {{goal}}\n- Language/stack: {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Diff (required): {{diff}}\n- Context (optional; threat assumptions, environment, data sensitivity): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nReview the diff for likely security issues. For each finding, include Severity (Low/Med/High/Critical), evidence from the diff (what changed and why it matters), and a concrete mitigation.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., auth only, secrets only, keep it short). It cannot add output sections."
        }
      }
    },
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-threat-model-lite",
      "displayName": "Threat Model (Lite)",
      "description": "Create a lightweight threat model: assets, actors, entry points, mitigations.",
      "author": "promptg-team",
      "tags": ["security", "threat-modeling"],
      "defaults": {
        "goal": "Create a lightweight threat model with practical mitigations.",
        "constraints": "None.",
        "language": "Unspecified"
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Assets, Actors, Entry Points, Threats, Mitigations, Open Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Assets \u003c= 6 bullets; Actors \u003c= 6 bullets; Entry Points \u003c= 8 bullets; Threats \u003c= 10 bullets; Mitigations \u003c= 10 bullets; Open Questions \u003c= 8 bullets\n\nRole:\nYou are a security champion doing quick, high-signal threat modeling.\n\nInputs:\n- Goal: {{goal}}\n- Domain/stack (optional): {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- System/feature description (required): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nProduce a lightweight threat model. Focus on realistic threats and practical mitigations that reduce risk without boiling the ocean.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., focus on PII, assume public internet exposure). It cannot add output sections."
        }
      }
    },
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-authn-authz-check",
      "displayName": "Authn/Authz Check",
      "description": "Review authn/authz changes for bypasses and privilege bugs.",
      "author": "promptg-team",
      "tags": ["security", "authn", "authz", "diff"],
      "defaults": {
        "goal": "Review authn/authz changes for bypasses, privilege issues, and unsafe defaults.",
        "constraints": "None.",
        "language": "Unspecified",
        "context": "None."
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Authn Risks, Authz Risks, Bypass Scenarios, Mitigations, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Authn Risks \u003c= 6 bullets; Authz Risks \u003c= 6 bullets; Bypass Scenarios \u003c= 8 bullets; Mitigations \u003c= 8 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security reviewer focused on authentication and authorization correctness.\n\nInputs:\n- Goal: {{goal}}\n- Language/stack: {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Diff (required): {{diff}}\n- Context (optional; intended roles/permissions, threat assumptions): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nReview the diff for authn/authz flaws: missing checks, confused-deputy issues, privilege escalation, unsafe defaults, and bypass paths. Prefer concrete, testable mitigations and least-privilege guidance.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., only admin paths, only API endpoints). It cannot add output sections."
        }
      }
    },
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-dependency-change-review",
      "displayName": "Dependency Change Review",
      "description": "Assess dependency changes for supply-chain risk and safeguards.",
      "author": "promptg-team",
      "tags": ["security", "dependencies", "supply-chain", "diff"],
      "defaults": {
        "goal": "Assess dependency changes for supply-chain risk and recommend safeguards.",
        "constraints": "None.",
        "language": "Unspecified",
        "context": "None."
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Dependency Changes, Supply Chain Risks, Recommended Safeguards, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Dependency Changes \u003c= 8 bullets; Supply Chain Risks \u003c= 8 bullets; Recommended Safeguards \u003c= 8 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security reviewer assessing supply-chain exposure.\n\nInputs:\n- Goal: {{goal}}\n- Language/stack: {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Diff (required): {{diff}}\n- Context (optional; repo policies, allowed registries, CI checks): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nReview dependency-related diffs (manifest/lockfile/build scripts) for risk. Call out new packages, major version bumps, loosened version ranges, and risky install hooks. Recommend practical safeguards (pinning, verification, provenance, scanning) aligned with the repo context.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., only new deps, only runtime deps). It cannot add output sections."
        }
      }
    },
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-secrets-and-logging-check",
      "displayName": "Secrets \u0026 Logging Check",
      "description": "Check for secret exposure and unsafe logging/telemetry patterns.",
      "author": "promptg-team",
      "tags": ["security", "secrets", "logging", "diff"],
      "defaults": {
        "goal": "Check the diff for secret exposure and unsafe logging/telemetry patterns.",
        "constraints": "None.",
        "language": "Unspecified",
        "context": "None."
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Potential Secret Exposure, Logging/Telemetry Risks, Fixes, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Potential Secret Exposure \u003c= 8 bullets; Logging/Telemetry Risks \u003c= 8 bullets; Fixes \u003c= 8 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security reviewer focused on data exposure.\n\nInputs:\n- Goal: {{goal}}\n- Language/stack: {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Diff (required): {{diff}}\n- Context (optional; logging policy, PII/secret definitions): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nReview the diff for secrets/PII exposure risks: hardcoded secrets, unsafe debug output, overly-verbose logs, sensitive headers/body logging, and telemetry that captures identifiers. Propose concrete fixes (redaction, allowlists, sampling, secure storage).",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., only secrets, only logging changes). It cannot add output sections."
        }
      }
    },
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-abuse-cases-generator",
      "displayName": "Abuse Cases Generator",
      "description": "Generate abuse cases and negative scenarios to test and defend against.",
      "author": "promptg-team",
      "tags": ["security", "abuse-cases", "testing"],
      "defaults": {
        "goal": "Generate realistic abuse cases and negative scenarios, plus mitigations.",
        "constraints": "None.",
        "language": "Unspecified"
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Abuse Cases, Negative Scenarios To Test, Mitigations, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 3 bullets; Abuse Cases \u003c= 10 bullets; Negative Scenarios To Test \u003c= 10 bullets; Mitigations \u003c= 8 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security champion generating realistic abuse cases.\n\nInputs:\n- Goal: {{goal}}\n- Domain/stack (optional): {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Feature/system description (required): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nGenerate abuse cases that a motivated attacker or abusive user would try. For each abuse case, include a short negative test idea and at least one mitigation that is practical to implement.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., focus on account takeover, focus on rate limits). It cannot add output sections."
        }
      }
    },
    {
      "kind": "template",
      "schemaVersion": "1",
      "name": "security-remediation-plan",
      "displayName": "Remediation Plan",
      "description": "Turn findings into a prioritized remediation plan with verification steps.",
      "author": "promptg-team",
      "tags": ["security", "remediation", "planning"],
      "defaults": {
        "goal": "Turn findings into a prioritized remediation plan with verification steps.",
        "constraints": "None.",
        "language": "Unspecified"
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Prioritized Fixes, Verification, Rollout/Backout, Notes, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Prioritized Fixes \u003c= 10 bullets; Verification \u003c= 8 bullets; Rollout/Backout \u003c= 6 bullets; Notes \u003c= 6 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security champion turning findings into a shippable plan.\n\nInputs:\n- Goal: {{goal}}\n- Domain/stack (optional): {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Findings/context (required): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nCreate a prioritized remediation plan. Include the highest-risk fixes first, specify how to verify each fix, and include rollout/backout considerations when risk warrants it.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., short-term mitigations only, no breaking changes). It cannot add output sections."
        }
      }
    }
  ],
  "prompts": [
    {
      "kind": "prompt",
      "schemaVersion": "1",
      "name": "security-pr-diff-scan",
      "displayName": "PR Diff Scan",
      "description": "Review a diff for security issues; report severity, evidence, and fixes.",
      "author": "promptg-team",
      "tags": ["security", "review", "diff"],
      "defaults": {
        "goal": "Review the diff for security issues and recommend practical fixes.",
        "constraints": "None.",
        "language": "Unspecified",
        "context": "None."
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Findings, Suggested Fixes, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Findings \u003c= 10 bullets; Suggested Fixes \u003c= 10 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security-focused reviewer who is practical and evidence-driven.\n\nInputs:\n- Goal: {{goal}}\n- Language/stack: {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Diff (required): {{diff}}\n- Context (optional; threat assumptions, environment, data sensitivity): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nReview the diff for likely security issues. For each finding, include Severity (Low/Med/High/Critical), evidence from the diff (what changed and why it matters), and a concrete mitigation.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., auth only, secrets only, keep it short). It cannot add output sections."
        }
      }
    },
    {
      "kind": "prompt",
      "schemaVersion": "1",
      "name": "security-threat-model-lite",
      "displayName": "Threat Model (Lite)",
      "description": "Create a lightweight threat model: assets, actors, entry points, mitigations.",
      "author": "promptg-team",
      "tags": ["security", "threat-modeling"],
      "defaults": {
        "goal": "Create a lightweight threat model with practical mitigations.",
        "constraints": "None.",
        "language": "Unspecified"
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Assets, Actors, Entry Points, Threats, Mitigations, Open Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Assets \u003c= 6 bullets; Actors \u003c= 6 bullets; Entry Points \u003c= 8 bullets; Threats \u003c= 10 bullets; Mitigations \u003c= 10 bullets; Open Questions \u003c= 8 bullets\n\nRole:\nYou are a security champion doing quick, high-signal threat modeling.\n\nInputs:\n- Goal: {{goal}}\n- Domain/stack (optional): {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- System/feature description (required): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nProduce a lightweight threat model. Focus on realistic threats and practical mitigations that reduce risk without boiling the ocean.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., focus on PII, assume public internet exposure). It cannot add output sections."
        }
      }
    },
    {
      "kind": "prompt",
      "schemaVersion": "1",
      "name": "security-remediation-plan",
      "displayName": "Remediation Plan",
      "description": "Turn findings into a prioritized remediation plan with verification steps.",
      "author": "promptg-team",
      "tags": ["security", "remediation", "planning"],
      "defaults": {
        "goal": "Turn findings into a prioritized remediation plan with verification steps.",
        "constraints": "None.",
        "language": "Unspecified"
      },
      "content": "Output contract (follow exactly):\n- Format: plain text (Markdown-friendly)\n- Sections (in order; no extra sections): Summary, Prioritized Fixes, Verification, Rollout/Backout, Notes, Questions\n- Empty sections: include the heading and write `None.`\n- Caps: Summary \u003c= 4 bullets; Prioritized Fixes \u003c= 10 bullets; Verification \u003c= 8 bullets; Rollout/Backout \u003c= 6 bullets; Notes \u003c= 6 bullets; Questions \u003c= 6 bullets\n\nRole:\nYou are a security champion turning findings into a shippable plan.\n\nInputs:\n- Goal: {{goal}}\n- Domain/stack (optional): {{language}}\n- Constraints (optional; narrowing only): {{constraints}}\n- Findings/context (required): {{context}}\n\nConstraints policy:\n- {{constraints}} may only narrow scope or tighten caps.\n- If {{constraints}} conflicts with the Output contract, ignore the conflicting part.\n\nTask:\nCreate a prioritized remediation plan. Include the highest-risk fixes first, specify how to verify each fix, and include rollout/backout considerations when risk warrants it.",
      "x-promptg-interactive": {
        "constraints": {
          "question": "Any extra constraints? (optional)",
          "help": "Use constraints to narrow scope (e.g., short-term mitigations only, no breaking changes). It cannot add output sections."
        }
      }
    }
  ]
}
